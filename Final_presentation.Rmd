---
title: "CC Impacts Presentation"
author: "Kristen Boysen, Jennifer Kidson, Juliano Palacios-Abrantes"
date: "March 9, 2016"
output: ioslides_presentation
logo: Bren_logo_216.png
runtime: shiny
---
##"Climate Impacts"
####Juliano Palacios-Abrantes
####Jennifer Kidson
####Kristen Boysen



```{r setup, include=TRUE}
```

## South Coast Water Production

```{r, include = FALSE}
library(streamgraph)
library(readr)
library(tidyr)
library(dplyr)

watersup = read_csv("./Data/watersup.csv")
watersup$Date = as.Date(watersup$Date, format = "%Y-%m-%d")

watersup %>%
  gather(source, AF, SWP:Recycled) %>%
  streamgraph("source","AF","Date") %>%
  sg_axis_x(1, "Date", "%Y") %>%
  sg_legend(show=TRUE, label="Sources: ") -> SCwater

#South Coast Water Production by Year (1998-2014)
SCwater
```

```{r SC Water, echo = FALSE}
SCwater
```

## Sankey Diagram - Water Supply

```{r sankey test, include=FALSE}
library(dplyr)
library(readr)
library(networkD3)
nodes = read_csv("./Data/p1.csv") %>%
  as.data.frame()

links = read_csv("./Data/p2.csv") %>%
  filter(Value!=0) %>% ##not equal to 0 
  # sankey links numbering needs to start at 0
  mutate(
    Source = Source - 1,
    Target = Target - 1) %>%
  as.data.frame()

sankeyNetwork(
  Links = links, Nodes = nodes, Source = "Source",
  Target = "Target", Value = "Value", NodeID = "name",
  units = "AF", fontSize = 12, nodeWidth = 30) -> SCsankey
```

```{r Sankey Slide, echo = FALSE}
SCsankey
```

## THE package

```{r Data, echo=FALSE, eval=FALSE}
suppressWarnings(library(dplyr))
suppressWarnings(library(knitr))
CSData <- read.csv("./Data/CSData.csv")

Data <- select(CSData,Target)
```

```{r psim, echo = TRUE, fig.width= 6, fig.height=6, eval=FALSE}
library(devtools)
library(psim)
#install_github("jepa/jepa.github.io", subdir = "psim")
```

![psimshot](Images/psimshot.png)

```{r Function, echo=FALSE, warning=FALSE,message=FALSE, eval=FALSE}
column= 1
CSs = 2
pro = 66
simulations = 1000
test="w.test"

Cs2<- psim(data=Data,column=column,n=2,pro=pro,sim=simulations,test=test)
Cs3<- psim(data=Data,column=column,n=3,pro=pro,sim=simulations,test=test)
Cs4<- psim(data=Data,column=column,n=4,pro=pro,sim=simulations,test=test)
Cs5<- psim(data=Data,column=column,n=5,pro=pro,sim=simulations,test=test)
Cs6<- psim(data=Data,column=column,n=6,pro=pro,sim=simulations,test=test)
Cs7<- psim(data=Data,column=column,n=7,pro=pro,sim=simulations,test=test)
Cs8<- psim(data=Data,column=column,n=8,pro=pro,sim=simulations,test=test)
Cs9<- psim(data=Data,column=column,n=9,pro=pro,sim=simulations,test=test)
Cs10<- psim(data=Data,column=column,n=10,pro=pro,sim=simulations,test=test)


FinalResults<- matrix(c(Cs2$Significant,Cs3$Significant,Cs4$Significant,Cs5$Significant,Cs6$Significant,Cs7$Significant,Cs8$Significant,Cs9$Significant,Cs10$Significant,Cs2$No_significant,Cs3$No_significant,Cs4$No_significant,Cs5$No_significant,Cs6$No_significant,Cs7$No_significant,Cs8$No_significant,Cs9$No_significant,Cs10$No_significant), ncol=2)
#head(FinalResults)

colnames(FinalResults) <- c("Significant","No Significant")
rownames(FinalResults) <- c("Cs2","Cs3","Cs4","Cs5","Cs6","Cs7","Cs8","Cs9","Cs10")
FinalResults <- kable(FinalResults)
```

## Package Example 

```{r Kable, fig.width= 6, fig.height=6, eval=FALSE}
FinalResults
```
